const {
    isArray,
    find,
    remove,
    unionBy,
    sortBy,
    uniqBy,
    keys,
    findIndex,
    maxBy,
    max,
    zipObject,
    flattenDeep,
    values,
    uniqWith,
    isEqual,
    mean,
    extend

} = require("lodash")

const jsondiffpatch = require('jsondiffpatch')
const SegmentDiff = require("./segment-diff")
const format = require("./diff").Diff.format

const fields = [
    "Recording Informativeness",
    "Other murmurs",
    "S1 Description",
    "S3",
    "Type of artifacts , Artifact",
    "S2 Split Type",
    "S1 Split Type",
    "S2 description",
    "2nd level comments",
    "Systolic murmurs",
    "Diastolic murmurs",
    "Arterial murmur",
    "Pathological findings",
    "Confidence",
    "S4",
    "Arrhythmia at the moment of recording",
    "S1 Mitral component Loudness",
    "S3 Type",
    "Final comments"
]


const Diff = jsondiffpatch.create({
    objectHash: (d, index)  => d.id || d,
    propertyFilter: name => fields.includes(name)
})



const diff2 = (r1, r2) => {
    return {
            formatted:format(Diff.diff(r1, r2)),
            patch: Diff.diff(r1, r2)
    }
}

const diffs = records => {
    records = (isArray(records || [])) ? records : [records]
    let res = []

    for (let i = 0; i < records.length - 1; i++) {
        res.push(diff2(records[i], records[i + 1]))
    }

    return {
        label: res,
        segmentation: SegmentDiff.diffs(records.map(d => d.segmentation))
    }    

}

const getNonConsistency = diffs => {

    return {
        label: sortBy(uniqBy(flattenDeep(diffs.label.map(d => d.formatted.map(d => d.key).filter(d => d))))),
        segmentation: SegmentDiff.getNonConsistencyIntervals(diffs.segmentation)
    }
}


const hasNonConsistency = diffs => {
    let res = getNonConsistency(diffs)
    return res.label.length > 0 || res.segmentation.length > 0
}


module.exports = {
    diff2,
    diffs,
    getNonConsistency,
    hasNonConsistency
}



// const run = async () => {
//     const r1 = {
//   "_id": {
//     "$oid": "6596f9bfc117977883a036bf"
//   },
//   "id": "69691f0c-e21a-490d-adc0-1a35822d1d18",
//   "Segmentation URL": "http://ec2-54-235-192-121.compute-1.amazonaws.com:8002/?record_v3=9ASbG0DQawa2ajr0APjbqhVz8pG2/recordings/Android_4eVQ74Ia3ROMc0PPHZLR&patientId=POT0340&position=supine&spot=tricuspid&device=android",
//   "Examination ID": "POT0340",
//   "Source": {
//     "path": "9ASbG0DQawa2ajr0APjbqhVz8pG2/recordings/Android_4eVQ74Ia3ROMc0PPHZLR",
//     "url": "https://firebasestorage.googleapis.com/v0/b/stethophonedata.appspot.com/o/9ASbG0DQawa2ajr0APjbqhVz8pG2%2Frecordings%2FAndroid_4eVQ74Ia3ROMc0PPHZLR?alt=media&token=3f45dec2-10ff-42c4-9e48-024f896d5af7"
//   },
//   "Clinic": "POTASHEV",
//   "Age (Years)": "33",
//   "Sex at Birth": "Female",
//   "Ethnicity": "White",
//   "model": "android",
//   "deviceDescription": {
//     "osVersion": "13",
//     "model": "SM-S908B",
//     "deviceId": "TP1A.220624.014",
//     "brand": "samsung",
//     "manufacturer": "samsung"
//   },
//   "Body Position": "supine",
//   "Body Spot": "Tricuspid",
//   "Type of artifacts , Artifact": [
//     "Bowel sound"
//   ],
//   "Systolic murmurs": [
//     "Ejection Type Murmur"
//   ],
//   "Diastolic murmurs": [
//     "No diastolic murmurs"
//   ],
//   "Other murmurs": [
//     "No Other Murmurs"
//   ],
//   "Pathological findings": [
//     "No Pathology"
//   ],
//   "path": "9ASbG0DQawa2ajr0APjbqhVz8pG2/recordings/Android_4eVQ74Ia3ROMc0PPHZLR",
//   "state": "Assign 2nd expert",
//   "CMO": "Yaroslav Shpak",
//   "TODO": "Complete Labeling",
//   "updated at": "2024-01-11T03:38:02.693Z",
//   "updated by": "Jean Andrade",
//   "Stage Comment": "Added by import utils",
//   "assigned to": "Yaroslav Shpak",
//   "2nd expert": "Jean Andrade",
//   "1st expert": "Marco Antonio Lopez Garcia",
//   "Confidence": "Not Confident",
//   "nextTodo": "2nd stage completed",
//   "segmentation": {
//     "v2": true,
//     "S2": [
//       [
//         "0.098",
//         "0.165",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "0.822",
//         "0.901",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "1.548",
//         "1.637",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "2.260",
//         "2.344",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "2.982",
//         "3.052",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "3.701",
//         "3.772",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "4.453",
//         "4.530",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "5.269",
//         "5.343",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "6.118",
//         "6.190",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "6.958",
//         "7.022",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "7.781",
//         "7.858",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "8.579",
//         "8.650",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "9.405",
//         "9.475",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "10.220",
//         "10.299",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "11.025",
//         "11.102",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "11.812",
//         "11.884",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "12.610",
//         "12.698",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "13.400",
//         "13.491",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "14.190",
//         "14.275",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "14.952",
//         "15.028",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "15.700",
//         "15.778",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "16.389",
//         "16.474",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "17.094",
//         "17.167",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "17.791",
//         "17.864",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "18.503",
//         "18.592",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "19.205",
//         "19.294",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "19.934",
//         "20.026",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "20.686",
//         "20.757",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "21.422",
//         "21.496",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "22.162",
//         "22.240",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "22.933",
//         "23.022",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "23.687",
//         "23.763",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "24.433",
//         "24.502",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "25.164",
//         "25.243",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "25.918",
//         "25.996",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "26.659",
//         "26.748",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "27.406",
//         "27.487",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "28.136",
//         "28.207",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "28.883",
//         "28.955",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "29.629",
//         "29.712",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "30.380",
//         "30.461",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "31.127",
//         "31.213",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "31.847",
//         "31.938",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "32.575",
//         "32.656",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "33.316",
//         "33.403",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "34.087",
//         "34.177",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "34.877",
//         "34.958",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "35.644",
//         "35.717",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "36.397",
//         "36.472",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "37.148",
//         "37.231",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "37.899",
//         "37.972",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "38.652",
//         "38.716",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "39.393",
//         "39.464",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "40.137",
//         "40.215",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "40.905",
//         "40.979",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "41.667",
//         "41.738",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "42.406",
//         "42.469",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "43.157",
//         "43.228",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "43.901",
//         "43.975",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "44.668",
//         "44.740",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "45.451",
//         "45.533",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "46.249",
//         "46.327",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "47.038",
//         "47.105",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "47.823",
//         "47.908",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "48.641",
//         "48.724",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "49.452",
//         "49.528",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "50.267",
//         "50.342",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "51.061",
//         "51.143",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "51.863",
//         "51.941",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "52.669",
//         "52.753",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "53.482",
//         "53.554",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "54.274",
//         "54.349",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "55.085",
//         "55.158",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "55.894",
//         "55.965",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "56.694",
//         "56.777",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "57.482",
//         "57.556",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "58.262",
//         "58.337",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "59.043",
//         "59.115",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "59.819",
//         "59.889",
//         "0.000",
//         "22050.000"
//       ]
//     ],
//     "S1": [
//       [
//         "0.504",
//         "0.590",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "1.219",
//         "1.295",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "1.935",
//         "2.008",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "2.652",
//         "2.722",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "3.369",
//         "3.438",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "4.119",
//         "4.186",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "4.932",
//         "5.003",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "5.785",
//         "5.846",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "6.621",
//         "6.694",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "7.419",
//         "7.501",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "8.225",
//         "8.307",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "9.056",
//         "9.141",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "9.884",
//         "9.960",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "10.687",
//         "10.764",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "11.477",
//         "11.552",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "12.262",
//         "12.333",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "13.057",
//         "13.133",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "13.849",
//         "13.928",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "14.619",
//         "14.703",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "15.346",
//         "15.426",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "16.046",
//         "16.136",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "16.756",
//         "16.839",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "17.497",
//         "17.580",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "18.174",
//         "18.256",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "18.870",
//         "18.955",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "19.618",
//         "19.695",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "21.086",
//         "21.176",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "21.857",
//         "21.947",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "22.617",
//         "22.713",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "23.372",
//         "23.462",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "24.116",
//         "24.198",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "24.847",
//         "24.930",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "25.584",
//         "25.667",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "26.335",
//         "26.420",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "27.079",
//         "27.157",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "27.800",
//         "27.895",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "28.562",
//         "28.640",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "29.285",
//         "29.365",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "30.039",
//         "30.113",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "30.789",
//         "30.876",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "31.515",
//         "31.604",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "32.243",
//         "32.325",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "32.988",
//         "33.086",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "33.747",
//         "33.831",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "34.530",
//         "34.612",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "35.322",
//         "35.409",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "36.075",
//         "36.156",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "36.810",
//         "36.884",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "37.559",
//         "37.632",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "38.307",
//         "38.383",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "39.057",
//         "39.152",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "39.801",
//         "39.888",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "41.334",
//         "41.402",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "42.070",
//         "42.154",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "42.820",
//         "42.895",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "43.557",
//         "43.642",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "44.328",
//         "44.403",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "45.117",
//         "45.195",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "45.917",
//         "45.994",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "46.694",
//         "46.780",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "47.488",
//         "47.569",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "48.307",
//         "48.377",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "49.120",
//         "49.202",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "49.921",
//         "50.004",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "50.723",
//         "50.805",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "51.524",
//         "51.602",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "52.328",
//         "52.408",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "53.138",
//         "53.228",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "53.962",
//         "54.042",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "54.735",
//         "54.823",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "55.554",
//         "55.627",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "56.347",
//         "56.429",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "57.136",
//         "57.214",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "57.915",
//         "57.991",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "58.695",
//         "58.764",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "59.480",
//         "59.552",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "20.371",
//         "20.446",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "40.562",
//         "40.645",
//         "0.000",
//         "22050.000"
//       ]
//     ],
//     "unsegmentable": [
//       [
//         "0.000",
//         "0.098",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "59.889",
//         "60.000",
//         "0.000",
//         "22050.000"
//       ]
//     ],
//     "diastole": [
//       [
//         "0.165",
//         "0.504",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "0.901",
//         "1.219",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "1.637",
//         "1.935",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "2.344",
//         "2.652",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "3.052",
//         "3.369",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "3.772",
//         "4.119",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "4.530",
//         "4.932",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "5.343",
//         "5.785",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "6.190",
//         "6.621",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "7.022",
//         "7.419",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "7.858",
//         "8.225",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "8.650",
//         "9.056",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "9.475",
//         "9.884",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "10.299",
//         "10.687",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "11.102",
//         "11.477",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "11.884",
//         "12.262",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "12.698",
//         "13.057",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "13.491",
//         "13.849",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "14.275",
//         "14.619",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "15.028",
//         "15.346",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "15.778",
//         "16.046",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "16.474",
//         "16.756",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "17.167",
//         "17.497",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "17.864",
//         "18.174",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "18.592",
//         "18.870",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "19.294",
//         "19.618",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "20.026",
//         "20.371",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "20.757",
//         "21.086",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "21.496",
//         "21.857",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "22.240",
//         "22.617",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "23.022",
//         "23.372",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "23.763",
//         "24.116",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "24.502",
//         "24.847",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "25.243",
//         "25.584",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "25.996",
//         "26.335",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "26.748",
//         "27.079",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "27.487",
//         "27.800",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "28.207",
//         "28.562",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "28.955",
//         "29.285",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "29.712",
//         "30.039",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "30.461",
//         "30.789",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "31.213",
//         "31.515",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "31.938",
//         "32.243",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "32.656",
//         "32.988",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "33.403",
//         "33.747",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "34.177",
//         "34.530",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "34.958",
//         "35.322",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "35.717",
//         "36.075",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "36.472",
//         "36.810",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "37.231",
//         "37.559",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "37.972",
//         "38.307",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "38.716",
//         "39.057",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "39.464",
//         "39.801",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "40.215",
//         "40.562",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "40.979",
//         "41.334",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "41.738",
//         "42.070",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "42.469",
//         "42.820",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "43.228",
//         "43.557",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "43.975",
//         "44.328",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "44.740",
//         "45.117",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "45.533",
//         "45.917",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "46.327",
//         "46.694",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "47.105",
//         "47.488",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "47.908",
//         "48.307",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "48.724",
//         "49.120",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "49.528",
//         "49.921",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "50.342",
//         "50.723",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "51.143",
//         "51.524",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "51.941",
//         "52.328",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "52.753",
//         "53.138",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "53.554",
//         "53.962",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "54.349",
//         "54.735",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "55.158",
//         "55.554",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "55.965",
//         "56.347",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "56.777",
//         "57.136",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "57.556",
//         "57.915",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "58.337",
//         "58.695",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "59.115",
//         "59.480",
//         "0.000",
//         "22050.000"
//       ]
//     ],
//     "systole": [
//       [
//         "0.590",
//         "0.822",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "1.295",
//         "1.548",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "2.008",
//         "2.260",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "2.722",
//         "2.982",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "3.438",
//         "3.701",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "4.186",
//         "4.453",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "5.003",
//         "5.269",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "5.846",
//         "6.118",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "6.694",
//         "6.958",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "7.501",
//         "7.781",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "8.307",
//         "8.579",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "9.141",
//         "9.405",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "9.960",
//         "10.220",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "10.764",
//         "11.025",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "11.552",
//         "11.812",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "12.333",
//         "12.610",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "13.133",
//         "13.400",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "13.928",
//         "14.190",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "14.703",
//         "14.952",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "15.426",
//         "15.700",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "16.136",
//         "16.389",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "16.839",
//         "17.094",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "17.580",
//         "17.791",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "18.256",
//         "18.503",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "18.955",
//         "19.205",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "19.695",
//         "19.934",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "20.446",
//         "20.686",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "21.176",
//         "21.422",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "21.947",
//         "22.162",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "22.713",
//         "22.933",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "23.462",
//         "23.687",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "24.198",
//         "24.433",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "24.930",
//         "25.164",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "25.667",
//         "25.918",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "26.420",
//         "26.659",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "27.157",
//         "27.406",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "27.895",
//         "28.136",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "28.640",
//         "28.883",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "29.365",
//         "29.629",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "30.113",
//         "30.380",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "30.876",
//         "31.127",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "31.604",
//         "31.847",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "32.325",
//         "32.575",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "33.086",
//         "33.316",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "33.831",
//         "34.087",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "34.612",
//         "34.877",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "35.409",
//         "35.644",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "36.156",
//         "36.397",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "36.884",
//         "37.148",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "37.632",
//         "37.899",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "38.383",
//         "38.652",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "39.152",
//         "39.393",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "39.888",
//         "40.137",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "40.645",
//         "40.905",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "41.402",
//         "41.667",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "42.154",
//         "42.406",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "42.895",
//         "43.157",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "43.642",
//         "43.901",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "44.403",
//         "44.668",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "45.195",
//         "45.451",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "45.994",
//         "46.249",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "46.780",
//         "47.038",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "47.569",
//         "47.823",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "48.377",
//         "48.641",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "49.202",
//         "49.452",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "50.004",
//         "50.267",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "50.805",
//         "51.061",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "51.602",
//         "51.863",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "52.408",
//         "52.669",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "53.228",
//         "53.482",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "54.042",
//         "54.274",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "54.823",
//         "55.085",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "55.627",
//         "55.894",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "56.429",
//         "56.694",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "57.214",
//         "57.482",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "57.991",
//         "58.262",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "58.764",
//         "59.043",
//         "0.000",
//         "22050.000"
//       ],
//       [
//         "59.552",
//         "59.819",
//         "0.000",
//         "22050.000"
//       ]
//     ],
//     "quality": "good",
//     "murmur_present": "yes",
//     "heart_rate": 78
//   },
//   "complete": 100,
//   "Arrhythmia at the moment of recording": "No arrhythmia",
//   "S4": "No present",
//   "S3": "No present",
//   "Recording Informativeness": "Good",
//   "FINALIZED": false
// }


//     let r2 = JSON.parse(JSON.stringify(r1))
//     // delete r2.segmentation
//     // r2["Pathological findings"] = ["Confident", "A"]
//     // delete r2.segmentation
//     delete r1.segmentation
    
//     console.log(diffs([r1, r2]))
//     console.log(getNonConsistency(diffs([r1, r2])))
//     console.log(hasNonConsistency(diffs([r1, r2])))


    
// }

// run()